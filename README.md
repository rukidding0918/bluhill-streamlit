# 블루힐 한의원 웹사이트 🏥

Streamlit 기반의 한의원 웹사이트로, 사용자 인증, 문의 게시판, 후기 시스템, 관리자 기능을 제공합니다.

## 주요 기능

### 🌐 공개 메뉴
- **한의원 소개**
  - 의료진 소개
  - 위치 및 진료시간
  - 칼럼
- **진료과목**
  - 통증치료
  - 추나요법
  - 녹용한약
  - 공진단

### 👤 로그인 사용자 기능
- 💬 **문의글 작성**: 공개/비공개 선택 가능
  - 비공개 문의: 작성자와 관리자만 확인 가능
  - 공개 문의: 모든 사용자 확인 가능
- ⭐ **치료 후기 작성**: 치료 경험 공유

### 🔧 관리자 기능
- 📋 **문의글 관리**: 답변 여부 필터, 답변 작성/수정
- 📝 **칼럼 작성**: 한의원 정보 및 건강 칼럼 작성

## 설치 및 실행

### 필수 요구사항

- Python 3.8 이상
- pip 패키지 관리자

### 설치 단계

1. **저장소 클론**
   ```bash
   git clone https://github.com/rukidding0918/bluhill-streamlit.git
   cd bluhill-streamlit
   ```

2. **의존성 설치**
   ```bash
   pip install -r requirements.txt
   ```

3. **애플리케이션 실행**
   ```bash
   streamlit run app.py
   ```

4. **브라우저 접속**

   자동으로 브라우저가 열리며 `http://localhost:8501`로 접속됩니다.

## 사용자 계정

테스트를 위한 기본 계정이 제공됩니다:

### 일반 사용자
- 사용자명: `user1` / 비밀번호: `password1`
- 사용자명: `user2` / 비밀번호: `password2`

### 관리자
- 사용자명: `admin1` / 비밀번호: `admin123`

## 프로젝트 구조

```
bluhill-streamlit/
├── app.py                 # 메인 애플리케이션
├── users.yaml             # 사용자 정보
├── requirements.txt       # 의존성 패키지
│
├── content/               # 콘텐츠 디렉토리
│   ├── public/           # 공개 페이지 (마크다운)
│   │   ├── 01_의료진.md
│   │   ├── 02_위치및진료시간.md
│   │   ├── 03_칼럼.md
│   │   ├── 04_통증치료.md
│   │   ├── 05_추나요법.md
│   │   ├── 06_녹용한약.md
│   │   └── 07_공진단.md
│   ├── user/             # 사용자 전용 콘텐츠
│   └── special/          # 특별 콘텐츠
│
├── data/                  # 데이터 저장소
│   ├── inquiries.yaml    # 문의글 데이터
│   ├── reviews.yaml      # 후기 데이터
│   └── columns.yaml      # 칼럼 데이터
│
└── tests/                 # 테스트 파일
    ├── conftest.py
    ├── test_auth.py
    ├── test_file_operations.py
    └── test_access_control.py
```

## 기능 상세 설명

### 📄 공개 콘텐츠
- 누구나 접근 가능한 한의원 소개 및 진료과목 정보
- 마크다운 형식으로 작성된 상세 정보 제공

### 💬 문의 시스템
- **공개 문의**: 모든 사용자가 확인 가능
- **비공개 문의**: 작성자와 관리자만 확인 가능
- 답변 여부 표시 (대기중/답변완료)
- 관리자 답변 작성 및 수정 기능

### ⭐ 후기 시스템
- 로그인 사용자만 작성 가능
- 모든 사용자가 확인 가능
- 작성일시 및 작성자 정보 표시

### 📝 칼럼 관리
- 관리자가 칼럼 작성 및 삭제 가능
- 작성된 칼럼은 공개 메뉴의 "칼럼" 섹션에 자동 표시
- 마크다운 형식 지원

## 사용자 관리

`users.yaml` 파일을 편집하여 사용자를 추가/수정할 수 있습니다:

```yaml
users:
  username:
    password: "password"
    role: "user"  # user, admin
    name: "Display Name"
```

## 역할 및 권한

| 역할 | 공개 메뉴 | 문의/후기 작성 | 문의/후기 확인 | 관리자 기능 |
|------|----------|---------------|---------------|------------|
| 비로그인 | ✅ | ❌ | 공개 문의만 | ❌ |
| User | ✅ | ✅ | 공개+본인 비공개 | ❌ |
| Admin | ✅ | ✅ | 모든 문의 | ✅ |

## 데이터 관리

### 문의글 데이터 (inquiries.yaml)
- ID, 작성자, 제목, 내용, 공개여부, 답변여부, 답변내용, 작성일시

### 후기 데이터 (reviews.yaml)
- ID, 작성자, 제목, 내용, 작성일시

### 칼럼 데이터 (columns.yaml)
- ID, 작성자, 제목, 내용, 작성일시

## 테스트

이 프로젝트는 pytest를 사용한 포괄적인 테스트 스위트를 포함하고 있습니다.

### 테스트 실행

```bash
# 모든 테스트 실행
pytest

# 상세 출력과 함께 실행
pytest -v

# 코드 커버리지 포함
pytest --cov=app --cov-report=html
```

### 테스트 구조

```
tests/
├── conftest.py              # 공통 fixture 및 설정
├── test_auth.py             # 인증 기능 테스트
├── test_file_operations.py  # 파일 로딩 및 보안 테스트
└── test_access_control.py   # 역할 기반 접근 제어 테스트
```

## 보안 고려사항

⚠️ **중요**: 현재 구현은 개발/데모 목적입니다. 프로덕션 환경에서는 다음을 고려하세요:

- ✅ 경로 순회 공격 방지 구현됨
- ⚠️ 비밀번호 해싱 필요 (bcrypt, argon2 등)
- ⚠️ HTTPS 사용 필수
- ⚠️ 환경 변수를 통한 민감 정보 관리
- ⚠️ 세션 보안 강화
- ⚠️ 데이터베이스 사용 권장 (현재 YAML 파일 사용)

## 콘텐츠 추가 및 수정

### 마크다운 페이지 추가
1. `content/public/` 디렉토리에 `.md` 파일 생성
2. 마크다운 형식으로 콘텐츠 작성
3. `app.py`의 `file_mapping`에 파일 경로 추가

### 칼럼 작성
1. 관리자 계정으로 로그인
2. "칼럼 작성" 탭 선택
3. 제목과 내용 입력 후 등록

## 향후 개선 사항

- [ ] 데이터베이스 연동 (SQLite, PostgreSQL)
- [ ] 비밀번호 해싱 구현
- [ ] 이메일 알림 기능
- [ ] 파일 업로드 기능 (치료 사진 등)
- [ ] 예약 시스템
- [ ] 결제 시스템 연동

## 라이선스

MIT License

## 기여

이슈 및 풀 리퀘스트를 환영합니다!

## 문의

프로젝트 관련 문의사항은 이슈를 통해 남겨주세요.
